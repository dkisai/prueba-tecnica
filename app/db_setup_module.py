# db_setup_module.py
from __future__ import annotations
import logging
import psycopg2

logger = logging.getLogger(__name__)

def ensure_alcaldias_and_stops_tables(db_config: dict) -> None:
    """
    Garantiza que existan las tablas 'alcaldias' y 'stops' en la base de datos
    pruebas_akron (ya existente), e inserta los datos iniciales sin duplicarlos.
    """

    logger.info("Conectando a la base de datos '%s' para crear/verificar tablas.", db_config["dbname"])
    
    with psycopg2.connect(**db_config) as conn:
        conn.autocommit = True
        with conn.cursor() as cur:
            # 1) Crear la tabla 'alcaldias' si no existe
            cur.execute("""
                CREATE TABLE IF NOT EXISTS alcaldias (
                    alcaldia_id SERIAL PRIMARY KEY,
                    alcaldia_nombre VARCHAR(255) NOT NULL UNIQUE
                );
            """)

            # 2) Crear la tabla 'stops' si no existe
            cur.execute("""
                CREATE TABLE IF NOT EXISTS stops (
                    stop_id SERIAL PRIMARY KEY,
                    stop_name VARCHAR(255) NOT NULL,
                    stop_lat FLOAT NOT NULL,
                    stop_lon FLOAT NOT NULL,
                    alcaldia_id INT NOT NULL,
                    CONSTRAINT fk_alcaldia
                        FOREIGN KEY (alcaldia_id)
                        REFERENCES alcaldias (alcaldia_id)
                );
            """)

            logger.info("Tablas 'alcaldias' y 'stops' creadas/verificadas.")

            # 3) Insertar alcaldías iniciales
            insert_alcaldias_sql = """
                INSERT INTO alcaldias (alcaldia_nombre)
                VALUES
                    ('gustavo a madero'),
                    ('cuauhtemoc'),
                    ('tlalpan'),
                    ('benito juarez'),
                    ('alvaro obregon'),
                    ('coyoacan'),
                    ('iztacalco'),
                    ('miguel hidalgo'),
                    ('iztapalapa'),
                    ('venustiano carranza'),
                    ('xochimilco'),
                    ('azcapotzalco')
                ON CONFLICT (alcaldia_nombre) DO NOTHING;
            """
            cur.execute(insert_alcaldias_sql)

            logger.info("Alcaldías iniciales insertadas (o ya estaban registradas).")

            # (Opcional) Creamos un índice único para no duplicar paradas
            cur.execute("""
                DO $$
                BEGIN
                    IF NOT EXISTS (
                        SELECT 1
                        FROM information_schema.table_constraints
                        WHERE constraint_name = 'unique_stop_name_lat_lon'
                          AND table_name = 'stops'
                          AND table_schema = 'public'
                    ) THEN
                        ALTER TABLE stops
                        ADD CONSTRAINT unique_stop_name_lat_lon
                        UNIQUE (stop_name, stop_lat, stop_lon);
                    END IF;
                END$$;
            """)

            # 4) Insertar paradas iniciales
            insert_stops_sql = """
                INSERT INTO stops (stop_name, stop_lat, stop_lon, alcaldia_id)
                VALUES
                    ('Potrero', 19.47660808499176, -99.13265208566766, 1),
                    ('Circuito L1', 19.46262217936452, -99.14386723712764, 2),
                    ('San Simón', 19.45951903848959, -99.14643816862964, 2),
                    ('Manuel González', 19.456615046343, -99.14948159428556, 2),
                    ('Buenavista L1', 19.44691022319351, -99.15307779648693, 2),
                    ('El Chopo', 19.44349969896119, -99.15434496585382, 2),
                    ('Revolución', 19.44038555031536, -99.15537707771638, 2),
                    ('Plaza de la República L1', 19.43597072042957, -99.15739044966492, 2),
                    ('Reforma L1', 19.43279916313105, -99.15879315610292, 2),
                    ('Hamburgo L1', 19.42783415435309, -99.16106475746773, 2),
                    ('Insurgentes Pte', 19.42410906772833, -99.16333142064485, 2),
                    ('Insurgentes Ote', 19.42337240356835, -99.16248154356877, 2),
                    ('Durango', 19.41997622456321, -99.16401286952053, 2),
                    ('Álvaro Obregón', 19.41653448382856, -99.16509146537012, 2),
                    ('Sonora', 19.41341136250927, -99.16610369884101, 2),
                    ('Campeche', 19.409778514779635, -99.16727274656297, 2),
                    ('Chilpancingo', 19.40668064654693, -99.16823652746277, 2),
                    ('El Caminero', 19.279400394618126, -99.16906731453443, 3),
                    ('Nuevo León L1', 19.40204269480295, -99.16975234012803, 2),
                    ('La Joya', 19.28035536452082, -99.1700111751622, 3),
                    ('La Piedad', 19.39776384658177, -99.1711536312679, 4),
                    ('Polifórum', 19.39321394751125, -99.17270136797299, 4),
                    ('Nápoles', 19.3896222909298, -99.1737990029131, 4),
                    ('Fuentes Brotantes', 19.288058811090515, -99.17459785938263, 3),
                    ('Colonia del Valle', 19.38571354863733, -99.17506613534312, 4),
                    ('Santa Úrsula', 19.2833661880905, -99.17534005596502, 3),
                    ('Ciudad de los Deportes', 19.38231253098864, -99.17616458743342, 4),
                    ('Parque Hundido', 19.37946791221312, -99.17708587836776, 4),
                    ('Ayuntamiento', 19.29264531575584, -99.17763856633142, 3),
                    ('Félix Cuevas Norte', 19.37417510761703, -99.17880853652245, 4),
                    ('Río Churubusco', 19.3689094354125, -99.18051144595017, 4),
                    ('Corregidora', 19.29410519454726, -99.1811098140218, 3),
                    ('Teatro de los Insurgentes', 19.36490532773127, -99.18180902259563, 4),
                    ('José María Velasco', 19.36176208219084, -99.18289663563067, 5),
                    ('Francia', 19.35830456967379, -99.18395139276464, 5),
                    ('Olivo', 19.35464537755246, -99.18513616213698, 5),
                    ('Villa Olímpica', 19.29914752169245, -99.18548736821604, 3),
                    ('Perisur', 19.30415178639366, -99.18610776319284, 6),
                    ('Altavista', 19.35077189255606, -99.18638186734991, 5),
                    ('La Bombilla', 19.34689513084349, -99.1877655336048, 5),
                    ('Dep. 18 Mzo. L1', 19.48644922699015, -99.1245180831272, 1),
                    ('Euzkaro', 19.48266224994973, -99.12762383746852, 1),
                    ('Ciudad Universitaria', 19.32290957807005, -99.18853534896722, 6),
                    ('Dr. Gálvez N', 19.341042854223954, -99.18992400169374, 5),
                    ('Hamburgo L7', 19.42995356797701, -99.16159558715809, 2),
                    ('Canal Apatlaco', 19.382831721916528, -99.11095976829529, 7),
                    ('El Salvador.', 19.430103956320657, -99.13943117569187, 2),
                    ('Antropología', 19.4247146195983, -99.18433425390691, 8),
                    ('Hospital General', 19.40571073731026, -99.11357273352769, 7),
                    ('Mercado Beethoven.', 19.45776866628389, -99.12894501191792, 2),
                    ('Gral. Antonio de León', 19.38538109479915, -99.05174036704837, 9),
                    ('La Villa', 19.48538679588978, -99.11961923523324, 1),
                    ('Alcaldía Cuauhtémoc.', 19.44224960421656, -99.15245705245135, 2),
                    ('Río Tecolutla', 19.38898881345624, -99.08310869219636, 9),
                    ('Clave.', 19.46452705261204, -99.12636622517854, 1),
                    ('Churubusco Oriente', 19.371822505541452, -99.10795569419862, 9),
                    ('Chapultepec', 19.42404736609939, -99.17422532408303, 2),
                    ('Mixiuhca', 19.40810448063398, -99.11324457756353, 10),
                    ('Héroe de Nacozari', 19.47121961572696, -99.14505615056318, 1),
                    ('Reforma L7', 19.43139462535771, -99.15878777412368, 2),
                    ('Circuito Cuemanco', 19.281266236817235, -99.11672383546832, 11),
                    ('Museo San Carlos.', 19.43816830883542, -99.15030679248939, 2),
                    ('Ampliación Providencia', 19.47980574028463, -99.0752573857366, 1),
                    ('La Viga', 19.3980344618875, -99.12457248839455, 7),
                    ('Talismán L5', 19.471043005401103, -99.10138964653017, 1),
                    ('Tres Culturas.', 19.450419218071897, -99.13278222084047, 2),
                    ('Viaducto', 19.4013539708559, -99.16814444643246, 2),
                    ('Moctezuma L4', 19.42690637624361, -99.11189050214648, 10),
                    ('Glorieta de Violeta', 19.44153753371875, -99.14223668378563, 2),
                    ('Colegio de Bachilleres 3', 19.5115585384633, -99.19729620587957, 12),
                    ('San Lázaro Sur L5', 19.43037834048882, -99.11533134204778, 10),
                    ('Leyes de Reforma', 19.38342985116283, -99.06579952074638, 9),
                    ('Ferrocarril de Cintura', 19.436091134535975, -99.12146595493044, 10),
                    ('Vasco de Quiroga', 19.49335572058847, -99.09200459718706, 1),
                    ('Las Cruces', 19.42610178812354, -99.12963356957754, 2),
                    ('Las Bombas', 19.31175208539649, -99.11071672556673, 6),
                    ('Garibaldi.', 19.44373494066624, -99.13915836325555, 2),
                    ('Antropología.', 19.42460986932729, -99.1855224967003, 8),
                    ('La Virgen', 19.32056281851342, -99.11351641089671, 6),
                    ('Alameda Ote', 19.43076917615918, -99.05329763889314, 10),
                    ('Garrido', 19.48334381404806, -99.11930974316489, 1),
                    ('Poniente 134', 19.49270303566563, -99.15314945910443, 1),
                    ('Terminal 1 AICM', 19.435491574787854, -99.08328473567964, 10),
                    ('Teatro del Pueblo.', 19.43684268841996, -99.12721494676526, 2),
                    ('Norte 45', 19.49643830173505, -99.1599112622329, 12),
                    ('Aculco', 19.37487468473131, -99.10816130932012, 9),
                    ('República de Chile', 19.43794145112122, -99.13556854983581, 2),
                    ('Chapultepec.', 19.4237622753023, -99.1743357238685, 2),
                    ('Gustavo A. Madero L6', 19.48381020629003, -99.11221179986907, 1),
                    ('Hospital General de México', 19.48028459853183, -99.10118809388028, 1),
                    ('Coyuya', 19.39825356928997, -99.11670793250475, 7),
                    ('Vocacional 5', 19.4315880176397, -99.15016276518435, 2),
                    ('482.', 19.46688044841875, -99.07562037747935, 1),
                    ('Mixcalco', 19.43642638880353, -99.12409129051193, 2),
                    ('Etiopía L2', 19.39580386172431, -99.15484310065293, 4),
                    ('Archivo General de la Nación', 19.43547916718309, -99.11509750270481, 10),
                    ('Pino Suárez', 19.42647976879665, -99.13265135925384, 2),
                    ('El Ángel', 19.42662910664687, -99.16865225057253, 2),
                    ('Deportivo Eduardo Molina', 19.444703775537683, -99.11214477680835, 10),
                    ('Álamos', 19.39472362659874, -99.14292840265595, 4),
                    ('Campo Marte', 19.427038112725555, -99.19942208052352, 8),
                    ('Peralvillo', 19.45374215771039, -99.13062880709771, 2),
                    ('El Caballito', 19.43598752723021, -99.14911712743891, 2),
                    ('La Pradera', 19.47309234223951, -99.06868963967442, 1),
                    ('Necaxa', 19.4755833535742, -99.1222281914489, 1),
                    ('Plaza de la República', 19.43676089227536, -99.15416343718616, 2),
                    ('Gran Canal', 19.47699305175776, -99.0927986205793, 1),
                    ('Hidalgo L7.', 19.43665972711099, -99.14755218639137, 2),
                    ('Hamburgo L7.', 19.42923702484668, -99.16269389025892, 2),
                    ('Ganaderos', 19.35057740493938, -99.11106779038316, 9),
                    ('Teatro Blanquita.', 19.43866066882829, -99.14010855045186, 2),
                    ('Antonio Maceo.', 19.40488867552865, -99.18588057278963, 8),
                    ('Hospital Infantil de México', 19.487251676336573, -99.11379524856724, 1),
                    ('Reforma L7.', 19.43113379119255, -99.15854807887996, 2),
                    ('Canal de San Juan.', 19.39670924431783, -99.05653241568166, 9),
                    ('Garrido.', 19.48336571577664, -99.11927156786729, 1),
                    ('Glorieta de Colón L7', 19.43340340464894, -99.15432247440754, 2),
                    ('Río de los Remedios', 19.507095255392926, -99.08594052810977, 1),
                    ('Misterios', 19.46252558654364, -99.12715567292256, 1),
                    ('Victoria', 19.46745710792942, -99.10291850566865, 1),
                    ('Río Consulado', 19.45360728942292, -99.10859712211516, 1),
                    ('Isabel la Católica.', 19.42969438643439, -99.13658298116319, 2),
                    ('Tecnoparque', 19.50247870799058, -99.1789631534656, 12),
                    ('Recreo', 19.39379643116733, -99.11373331370532, 7),
                    ('Instituto del Petróleo', 19.493120426408, -99.14518007013932, 1),
                    ('San Lázaro Norte L5', 19.43121594141721, -99.11515242426117, 10),
                    ('De los Misterios L6', 19.48709536774331, -99.11798604802378, 1),
                    ('Rojo Gómez', 19.38448509710503, -99.07638129244677, 9),
                    ('Excélsior.', 19.47087054033968, -99.12393727991548, 1),
                    ('Poniente 146', 19.50003918814673, -99.15585362780902, 1),
                    ('Peralvillo.', 19.45272415998285, -99.13100686806469, 2),
                    ('Museo de la Ciudad', 19.42908847279102, -99.13272327093695, 2),
                    ('El Ángel.', 19.42645981755745, -99.16856450980642, 2),
                    ('Venustiano Carranza', 19.41872745676672, -99.11214699343756, 10),
                    ('Mercados de San Juan', 19.43081012718926, -99.14485271341727, 2),
                    ('Campo Marte.', 19.42667137087778, -99.19942824908911, 8),
                    ('Juárez L4', 19.43131325113527, -99.14829795870675, 2),
                    ('Magdalena de las Salinas', 19.48395379228881, -99.14983671861985, 1),
                    ('Del Moral.', 19.38419192549233, -99.07091038657421, 9),
                    ('Necaxa.', 19.47558421514649, -99.12220387458328, 1),
                    ('Plaza de la República.', 19.43774043603285, -99.15372851855605, 2),
                    ('El Coyol', 19.487631173893107, -99.09437566995624, 1),
                    ('Moctezuma L5', 19.42576400502085, -99.11138950983884, 10),
                    ('Xola', 19.39431958195676, -99.1401695213952, 4),
                    ('Tacubaya', 19.401935753664333, -99.18702244952318, 8),
                    ('Gustavo A. Madero L1', 19.48365291144993, -99.11387753581162, 1),
                    ('Tlacotal', 19.39719954556777, -99.10394772701466, 7),
                    ('Calle 6', 19.42111460450559, -99.05823243898395, 10),
                    ('Cecilio Robelo', 19.42521243215105, -99.11983707591222, 10),
                    ('México Tenochtitlan', 19.438900717911, -99.15328501597787, 2),
                    ('Pueblo de San Juan de Aragón', 19.47106893633869, -99.0864483538664, 1),
                    ('Teatro del Pueblo', 19.43690623745032, -99.1280425433411, 2),
                    ('Muyuguarda', 19.28500560533537, -99.1155517101288, 11),
                    ('Escuadrón 201', 19.366043065031867, -99.10920292139055, 9),
                    ('Isabel la Católica', 19.4296932240978, -99.13697212746823, 2),
                    ('Patriotismo', 19.40555150458669, -99.17743889458272, 8),
                    ('Metro Coyuya L2', 19.398353680213262, -99.11316722631456, 7),
                    ('República de Argentina', 19.43741414300866, -99.13148919519912, 2),
                    ('De los Misterios L7', 19.487148293692538, -99.11790728223045, 1),
                    ('Doctor Vértiz', 19.39558311097358, -99.15169123419294, 4),
                    ('Terminal 2 AICM', 19.42075, -99.07834, 10),
                    ('Robles Domínguez', 19.468559433136587, -99.12507562024805, 1),
                    ('París', 19.43256639378335, -99.15611023333271, 2),
                    ('Instituto Politécnico Nacional', 19.49039966973826, -99.13270661839263, 1),
                    ('Nuevo León L2', 19.40346918952325, -99.17036784567404, 2),
                    ('Barrio San Antonio', 19.34306244864715, -99.11244034767152, 9),
                    ('El Rosario', 19.507206060826725, -99.1995370388031, 12),
                    ('Júpiter', 19.50869086278045, -99.15921429944574, 1),
                    ('Lindavista - Vallejo', 19.49383965743074, -99.14814729049552, 1),
                    ('416 Oriente.', 19.47106083272982, -99.07092862579692, 1),
                    ('Dep. 18 Mzo. L6', 19.486493320266753, -99.12228405475616, 1),
                    ('Preparatoria 3', 19.48363851494554, -99.09617718028105, 1),
                    ('Oriente 101', 19.460945137833363, -99.10565972328186, 1),
                    ('Amores', 19.3969008833724, -99.1637764718804, 4),
                    ('Ermita-Iztapalapa', 19.35669502918896, -99.11128372286947, 9),
                    ('Eje Central.', 19.430260767084228, -99.14080471340098, 2),
                    ('Parque Lira', 19.40779267114004, -99.18911880979248, 8),
                    ('Manuela Sáenz', 19.324219522471914, -99.11397457122804, 6),
                    ('San Lázaro L4 Pte', 19.43060283632745, -99.11549329993498, 10),
                    ('Villa de Aragón', 19.46495633358672, -99.0596044614896, 1),
                    ('Preparatoria 1', 19.273470758768216, -99.12054598331451, 11),
                    ('El Rodeo', 19.39164014341617, -99.08710117144095, 7),
                    ('Misterios.', 19.46098810763295, -99.12770396840664, 2),
                    ('República de Argentina.', 19.43739936247409, -99.13164238551471, 2),
                    ('Canela', 19.39782631717387, -99.10943817787135, 7),
                    ('El Salvador', 19.429912154556657, -99.13856771740578, 2),
                    ('Gandhi', 19.42407365689417, -99.1800952806228, 8),
                    ('Metro Coyuya L5', 19.39955868276431, -99.11365193102631, 7),
                    ('Cuitláhuac', 19.47420383618805, -99.14615863546969, 1),
                    ('Coltongo', 19.47991934094695, -99.14835017820151, 1),
                    ('DIF Xochimilco', 19.276926740734268, -99.1183975338936, 11),
                    ('Poniente 128', 19.48948505456544, -99.15188617177483, 1),
                    ('Deportivo los Galeana', 19.4786245680706, -99.07798975266768, 1),
                    ('Oriente 116', 19.39016053867788, -99.11274787355202, 7),
                    ('Glorieta de Violeta.', 19.43967849572631, -99.14393385827869, 2),
                    ('Iztacalco', 19.39651781414634, -99.0959403573965, 7),
                    ('Vocacional 5.', 19.43175716266821, -99.15105388991816, 2),
                    ('414.', 19.46836192099835, -99.07161503265114, 1),
                    ('Mercado Sonora', 19.42321416268457, -99.12359545456292, 10),
                    ('Montevideo L3', 19.49615621230987, -99.15441578090893, 1),
                    ('Hospital Infantil de Morelos', 19.48805527433594, -99.11475284998424, 1),
                    ('Pueblo de los Reyes', 19.348045526479225, -99.11132454872133, 9),
                    ('Ferrocarriles Nacionales', 19.50487858685309, -99.18879344579429, 12),
                    ('Riobamba', 19.48863235378676, -99.127932685765, 1),
                    ('Const. de Apatzingán', 19.3890344498816, -99.05981096041994, 9),
                    ('Indios Verdes L7', 19.493247049086236, -99.1209780575117, 1),
                    ('México Tenochtitlan.', 19.43967077613262, -99.15299501617082, 2),
                    ('Casas Alemán', 19.47422035185774, -99.0883446948742, 1),
                    ('Hidalgo L4.', 19.43733106081757, -99.14617726339026, 2),
                    ('Apatlaco', 19.37802935588254, -99.10916805267334, 9),
                    ('Garibaldi', 19.44423650585254, -99.13961973294639, 2),
                    ('Gandhi.', 19.42393323720598, -99.18072750071761, 8),
                    ('Mercado Morelos', 19.441292787698163, -99.11342153420173, 10),
                    ('París.', 19.43249596572874, -99.15578123429812, 2),
                    ('Morelos.', 19.43583593720632, -99.11856710693506, 10),
                    ('Buenavista L3 Sur', 19.44575795469, -99.15214240550996, 2),
                    ('416 Poniente', 19.4724713707306, -99.0794027464215, 1),
                    ('Robles Domínguez.', 19.46701461200295, -99.1254319976437, 1),
                    ('San Juan de Aragón', 19.479921017407523, -99.09782553800144, 1),
                    ('Las Américas', 19.39341912299042, -99.13427728280912, 4),
                    ('La Diana', 19.4255894802327, -99.1709642675253, 2),
                    ('Avenida del Taller', 19.41259082641491, -99.11279134212441, 10),
                    ('Archivo General de la Nación', 19.437191903990865, -99.11438715802898, 10),
                    ('El Caballito.', 19.43510387143595, -99.15023892127793, 2),
                    ('Volcán de Fuego', 19.47707526470618, -99.07262158696162, 1),
                    ('Mixcalco.', 19.43639173059286, -99.12368444493966, 10),
                    ('Andrés Molina Enríquez', 19.39763143662469, -99.12970792326716, 7),
                    ('Norte 59', 19.49761176458131, -99.16563234198806, 12),
                    ('Colegio de Bachilleres 2', 19.4697695512927, -99.06486888101176, 1),
                    ('Av. Talismán.', 19.47831814056366, -99.12110989808147, 1),
                    ('UPIICSA', 19.39388378792517, -99.09037307831852, 7),
                    ('San Lázaro L4 Ote', 19.43051420139995, -99.11511446661133, 10),
                    ('Hospital la Raza', 19.4679596580588, -99.14390852670995, 1),
                    ('Circuito L3', 19.46334219924529, -99.1441892007768, 2),
                    ('Tolnáhuac', 19.46001684062002, -99.14410904995664, 2),
                    ('Tlatelolco', 19.45549884507741, -99.14504122737199, 2),
                    ('Ricardo Flores Magón', 19.45185897262619, -99.14598052188497, 2),
                    ('Guerrero', 19.44607193952419, -99.14726821197756, 2),
                    ('Buenavista L3 Norte', 19.4462663247002, -99.15186882019044, 2),
                    ('Mina', 19.44061027832123, -99.14849891099419, 2),
                    ('Hidalgo L3', 19.43599239734298, -99.14726910536872, 2),
                    ('Juárez L3', 19.43161579927953, -99.14795204658719, 2),
                    ('Balderas', 19.42803123052508, -99.14870111486628, 2),
                    ('Cuauhtémoc', 19.42495471505716, -99.15368419092368, 2),
                    ('Jardín Pushkin', 19.42045615138886, -99.1540355829869, 2),
                    ('Hospital General', 19.41443657880767, -99.15452357668178, 2),
                    ('Doctor Márquez', 19.41111860298619, -99.15478142701357, 2),
                    ('Centro Médico', 19.40731720822523, -99.15506623342795, 2),
                    ('Obrero Mundial', 19.40111877560081, -99.15555617790422, 4),
                    ('Etiopía L3', 19.39699601797086, -99.15585251940153, 4),
                    ('Luz Saviñón', 19.391494852300905, -99.1563642024994, 4),
                    ('Eugenia', 19.38580262042498, -99.15719174119745, 4),
                    ('División del Norte', 19.380422965925366, -99.1587781906128, 4),
                    ('Tenayuca', 19.528580256615665, -99.17009498309568, 1),
                    ('San José de la Escalera', 19.52284551981924, -99.16553223742903, 1),
                    ('Progreso Nacional', 19.51973102531605, -99.16375755812645, 1),
                    ('Tres Anegas', 19.51553462321563, -99.16193811033368, 1),
                    ('Miguel Laurent', 19.374901922322366, -99.16020780801774, 4),
                    ('Pueblo Sta. Cruz Atoyac', 19.37176683765246, -99.1609561443329, 4),
                    ('La Raza L3', 19.46728943839173, -99.1409392869112, 1),
                    ('Montevideo L6', 19.49486140385348, -99.15306176315282, 1),
                    ('La Raza L1', 19.46893328071212, -99.138741821136, 1),
                    ('Félix Cuevas Sur', 19.373064906661075, -99.17918980121613, 4),
                    ('C.C Universitario', 19.315140227263598, -99.18754220008852, 6),
                    ('Dr. Gálvez S', 19.34049291345023, -99.19010971122012, 5),
                    ('Buenavista L4.', 19.445370496337084, -99.15173956695763, 2),
                    ('Defensoría Pública.', 19.43322033809, -99.15058215583875, 2),
                    ('San Pablo.', 19.42536180082359, -99.13074356254411, 2),
                    ('Pino Suárez Sur.', 19.42609771544839, -99.13399228523217, 2),
                    ('20 de Noviembre.', 19.429322293658252, -99.13431912552662, 2),
                    ('Hidalgo L4 E4', 19.43739364834678, -99.14737343788148, 2),
                    ('Glorieta Cuitláhuac 1', 19.44921043641418, -99.13409682333013, 2),
                    ('Glorieta Cuitláhuac 2', 19.44744881725725, -99.1357418260385, 2),
                    ('Glorieta Cuitláhuac 3', 19.44735101867357, -99.1355121260966, 2),
                    ('Amajac. L7', 19.43397932675315, -99.15264015545559, 2),
                    ('Amajac L7', 19.43341099204709, -99.15433896624667, 2),
                    ('El Ahuehuete', 19.42842709003128, -99.16486729350108, 2),
                    ('El Ahuehuete.', 19.42811986293388, -99.16505995875143, 2),
                    ('Amajac L4', 19.43383193025979, -99.15350496899691, 2),
                    ('Amajac. L4', 19.43452441502888, -99.15339961396617, 2),
                    ('Alameda Tacubaya', 19.40152620146037, -99.18588459491731, 8),
                    ('De la Salle L72', 19.409120773710264, -99.18348401784898, 2),
                    ('De la Salle L72.', 19.4082996715027, -99.18421198126799, 8),
                    ('Dep. 18 Mzo. L1.', 19.48623793424297, -99.1244673728943, 1),
                    ('Euzkaro.', 19.48249627893007, -99.12754475940076, 1),
                    ('Potrero.', 19.47677258165376, -99.13216565546826, 1),
                    ('314 Memorial New''s', 19.500538931132954, -99.08845335245135, 1),
                    ('5 de Mayo.', 19.496981499237922, -99.08995270729065, 1),
                    ('Vasco de Quiroga.', 19.49321665493636, -99.09156471490863, 1),
                    ('El Coyol.', 19.48746681775229, -99.09398943185809, 1),
                    ('Preparatoria 3.', 19.483317402063772, -99.09581601619722, 1),
                    ('San Juan de Aragón 1.', 19.479853152749996, -99.09727782011034, 1),
                    ('Río de Guadalupe.', 19.475956415894355, -99.09893810749055, 1),
                    ('Talismán L5.', 19.470931737560875, -99.1011402010918, 1),
                    ('Victoria.', 19.46719808467222, -99.10268880978849, 1),
                    ('Oriente 101.', 19.46082627614275, -99.10540491342546, 1),
                    ('Río Santa Coleta.', 19.455995865643047, -99.10739511251451, 1),
                    ('Río Consulado.', 19.453590722786963, -99.10833120346071, 1),
                    ('Metro Coyuya L5.', 19.39923750658907, -99.11344095049589, 7),
                    ('Recreo.', 19.39381995397841, -99.11355882883075, 7),
                    ('Oriente 116.', 19.390234881259808, -99.11256641149522, 7),
                    ('Colegio de Bachilleres 3.', 19.38626261956645, -99.11157667636873, 7),
                    ('Canal Apatlaco.', 19.382867144532945, -99.1108337044716, 7),
                    ('Apatlaco.', 19.37830005600095, -99.10905517335338, 9),
                    ('Aculco.', 19.37466562527648, -99.10780695925321, 9),
                    ('Churubusco Oriente.', 19.3715996525542, -99.10773758942223, 9),
                    ('Ganaderos.', 19.35058848387328, -99.11075660798332, 9),
                    ('Preparatoria 1.', 19.273366951588805, -99.12046283483507, 11),
                    ('Pantitlán.', 19.41711665692743, -99.0741678984773, 10),
                    ('Indios Verdes L1.', 19.493863941319066, -99.1197654604912, 1);
                ON CONFLICT (stop_name, stop_lat, stop_lon) DO NOTHING;
            """
            cur.execute(insert_stops_sql)

            logger.info("Paradas iniciales insertadas (o ya estaban registradas).")

    logger.info("¡Listo! Tablas y datos básicos asegurados en '%s'.", db_config["dbname"])